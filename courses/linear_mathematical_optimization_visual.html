<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Theodore (Teddy) Lazebnik</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Theodore (Teddy) Lazebnik personal website" name="description">
    <meta content="Teddy Lazebnik" name="author">
	<!-- css -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/teddy_style.css" rel="stylesheet">
	
	<!-- P5 library -->
	<script src="https://cdn.jsdelivr.net/npm/p5@1.0.0/lib/p5.js"></script>

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-154895667-1"></script>
	<script src="../js/submission_table.js"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'UA-154895667-1');
	</script>
</head>

<body>
	<div class="row">
		<div class="col-lg-2 col-md-2 col-sm-1">
		
		</div>
		<div class="col-lg-8 col-md-8 col-sm-10">
			<div class="header">
				<h1>
				Theodore (Teddy) Lazebnik
				</h1>
			</div>
			<div class="menu">
				<ul>
					<li><a href="../index.html"> Short Bio </a></li>
					<li><a href="../publications.html"> Publications </a></li>
					<li><a href="../students.html"> Students </a></li>
					<li><a href="../opensource.html"> Open Resources </a></li>
					<li><a href="../teaching.html"> Teaching </a></li>
					<li><a href="" class="active">Linear Mathematical Optimization (Visuals) </a></li>
				</ul>
			</div>
			<div class="body">
				<div class="fluid-container">
					<div class="row">
					<div class="col-lg-12 col-md-12 col-sm-12">
						<div class="info" style="text-align: center;">
							<h3> Linear Mathematical Optimization visuals </h3>
								<p>This is a poses generator - not perfect yet... </p>
								<form style="text-align: left;">
									<div class="form-group">
									<label for="layers">New Condition</label>
										<input class="form-control" type="text" id="condition" placeholder="Add condition in the form 'a,b,c' for 'a*x + b*y < c'">
									</div>
								</form>
								<button class="btn btn-secondary" onclick="problem.addCondition();" style="margin-top: 10px; margin-bottom: 10px;">Add Condition</button>
								<button class="btn btn-warning" onclick="problem.removeLast();" style="margin-top: 10px; margin-bottom: 10px;">Remove Last Condition</button>
								<button class="btn btn-danger" onclick="problem.reset();" style="margin-top: 10px; margin-bottom: 10px;">Reset</button>
								<div id="canvas_container">
									
								</div>
						</div>
					</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<!-- Random image generator -->
	<script>
	
	let problem; // declare problem object
	
	class Problem
	{
		constructor() 
		{
			this.conditions = [new Condition(1,1,0)];
		}
		
		reset()
		{
			this.conditions = [];
			redraw();
		}
		
		removeLast()
		{
			this.conditions.pop();
			redraw();
		}
		
		addCondition()
		{
			var items = document.getElementById("condition").value.split(",");
			if (items.length == 3)
			{
				this.conditions.push(new Condition(parseInt(items[0]), parseInt(items[1]), parseInt(items[2])));
				document.getElementById("condition").value = "";
				// alert("add condition: " + items[0] + " * x + " + items[1] + " * y <= " + items[2]);
				redraw();
			}
			else
			{
				alert("Error - enter 'a,b,c' as a new condition");
			}
		}

		display(r) 
		{
			background(240); // clear last image
			strokeWeight(3);
			// print lines 
			for (var i = 0; i < this.conditions.length; i++)
			{
				this.conditions[i].display();
			}
			
			strokeWeight(1);
			// print all touching points 
			for (var i = 0; i < this.conditions.length - 1; i++)
			{
				for (var j = i + 1; j < this.conditions.length; j++)
				{
					var point = lineIntersection(this.conditions[i], this.conditions[j]);
					point.display(r);
					strokeWeight(0);
					text("(" + point.x + ", " + point.y + ")", point.x + 5, point.y - 10);
					strokeWeight(3);
				}
			}

			translate(0, height);
			
			// mark location
			strokeWeight(5);
			let v0 = createVector(0, height);
			let v1 = createVector(width, height);
			drawArrow(v0, v1, 'black');
			let v2 = createVector(0, 0);
			drawArrow(v0, v2, 'black');
		}
	}
	
	class Condition 
	{
		constructor(a, b, c) 
		{
			this.a = a;
			this.b = b;
			this.c = c;
		}

		display() 
		{
			var interactionsPoints = lineFrameIntersection(this);
			line(interactionsPoints[0].x + height, interactionsPoints[0].y, interactionsPoints[1].x, interactionsPoints[1].y);
			var centerPointOfLine = centerPoint(interactionsPoints[0], interactionsPoints[1]);
			strokeWeight(0);
			text(this.a + " * x + " + this.b + " * y <= " + this.c, centerPointOfLine.x, centerPointOfLine.y);
			strokeWeight(3);
		}
	}
	
	class Point 
	{
		constructor(x, y) 
		{
			this.x = x;
			this.y = y;
		}

		display(r) 
		{
			circle(x, y, r);
		}
	}
	
	function lineIntersection(cond1, cond2) 
	{
		x = (cond2.b * cond1.c - cond1.b * cond2.c) / (cond1.a * cond2.b - cond1.b * cond2.a);
		y = (cond1.c - cond1.a * x) / cond1.b
		return new Point(x,y);
	}
	
	function lineFrameIntersection(lineCond) 
	{
		var leftWall = FixPointCanvas(new Point(0, lineCond.c / lineCond.b));
		var rightWall = FixPointCanvas(new Point(width, (lineCond.c - lineCond.a * width) / lineCond.b));
		var bottomWall = FixPointCanvas(new Point(lineCond.c / lineCond.a, 0));
		var TopWall = FixPointCanvas(new Point((lineCond.c - lineCond.b * height) / lineCond.a, height));
		
		var hits = [];
		if (leftWall.y <= height && leftWall.y >= 0)
		{
			hits.push(leftWall);
		}
		if (rightWall.y <= height && rightWall.y >= 0)
		{
			hits.push(rightWall);
		}
		if (bottomWall.x <= width && bottomWall.x >= 0)
		{
			hits.push(bottomWall);
		}
		if (TopWall.x <= width && TopWall.x >= 0)
		{
			hits.push(TopWall);
		}
		return hits;
	}
	
	function centerPoint(p1, p2) 
	{
		return new Point((p1.x + p2.x) / 2, (p1.y + p2.y) / 2);
	}
	
	function FixPointCanvas(p) 
	{
		return new Point(p.x, height - p.y);
	}
	
	function drawArrow(base, vec, myColor) 
	{
	  push();
	  stroke(myColor);
	  strokeWeight(3);
	  fill(myColor);
	  translate(base.x, base.y);
	  line(0, 0, vec.x, vec.y);
	  rotate(vec.heading());
	  let arrowSize = 7;
	  translate(vec.mag() - arrowSize, 0);
	  triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);
	  pop();
	}
		
	function setup()
	{
		let cnv = createCanvas(400, 400); // create canvas to draw on
		cnv.parent('canvas_container'); // set the location of the canvas in the right div
		stroke(0); // Set line drawing color to white
		background(240); // set BG to white
		fill(100);
		frameRate(24);
		problem = new Problem();
		noLoop();
	}
	
	function draw()
	{
		problem.display(5);
	}
	</script>
</body>
</html>