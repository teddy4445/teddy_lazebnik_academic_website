<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <title>
   Deep Learning NN Visual - Teddy Lazebnik
  </title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="A simple visualization of FNN and CNN" name="description"/>
  <meta content="Teddy Lazebnik" name="author"/>
  <meta content="keywords" content="lazebnik, לזנבניק, teddy lazebnik" />
  <link href="../img/favicon.ico" rel="icon" type="image/x-icon"/>
  <!-- css -->
  <link crossorigin="anonymous" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" rel="stylesheet"/>
  <link href="../css/teddy_style.css" rel="stylesheet"/>
  <script type="application/ld+json">
   {
		  "@context": "https://schema.org",
		  "@type": "Course",
		  "name": "Deep Learning for Computer Vision",
		  "description": "An introduction to deep learning, focusing on computer vision tasks",
		  "provider": {
			"@type": "Organization",
			"name": "HIT"
		  }
		}
  </script>
  <!-- P5 library -->
  <script src="https://cdn.jsdelivr.net/npm/p5@1.0.0/lib/p5.js">
  </script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-154895667-1">
  </script>
  <script src="../js/submission_table.js">
  </script>
  <script>
   window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'UA-154895667-1');
  </script>
  <!-- Hotjar Tracking Code for http://teddylazebnik.info/ -->
  <script>
   (function(h,o,t,j,a,r){
			h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
			h._hjSettings={hjid:1812929,hjsv:6};
			a=o.getElementsByTagName('head')[0];
			r=o.createElement('script');r.async=1;
			r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
			a.appendChild(r);
		})(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
  </script>
 </head>
 <body>
  <div id="progressBar">
  </div>
  <div id="ScrollPath">
  </div>
  <div class="row">
   <div class="col-lg-12 col-md-12 col-sm-12 mobile-space">
    <nav class="navbar navbar-expand-lg">
     <a class="navbar-brand" href="../index.html" id="logo" title="Theodore (Teddy) Lazebnik">
      Theodore (Teddy) Lazebnik
     </a>
     <button aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#navbarSupportedContent" data-toggle="collapse" type="button">
      <img alt="menu" class="navbar-toggler-icon" src="https://img.icons8.com/ios-filled/50/000000/menu.png"/>
     </button>
     <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
       <li class="nav-item form-inline mobile" style="padding-bottom: 10px;">
        <input aria-label="Search" class="form-control input-search" id="search-data" placeholder="Search" type="search"/>
        <div class="input-group-append">
         <button class="btn btn-outline-white btn-search" onclick="return searchPage();">
          <img alt="search" src="https://img.icons8.com/android/24/000000/search.png"/>
         </button>
        </div>
       </li>
        <li class="nav-item">
        <a class="nav-link active" href="index.html" title="home page">
         Home
        </a>
       </li>
       <li class="nav-item dropdown">
        <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" id="navbarDropdown" role="button" title="Research">
         Research
        </a>
        <div aria-labelledby="navbarDropdown" class="dropdown-menu">
         <a class="dropdown-item" href="/publications.html" title="Academic Publications">
          Academic Publications
         </a>
         <a class="dropdown-item" href="/students.html" title="Research Students">
          Research Students
         </a>
        </div>
       </li>
       <li class="nav-item dropdown">
        <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" id="navbarDropdown" role="button" title="Teaching">
         Teaching
        </a>
        <div aria-labelledby="navbarDropdown" class="dropdown-menu">
         <h4 class="dropdown-item">
          Bar Ilan University
         </h4>
         <a class="dropdown-item" href="/courses/advanced-programming-one.html" title="Advanced Programming 1">
          Advanced Programming 1
         </a>
         <a class="dropdown-item" href="/courses/advanced-programming-two.html" title="Advanced Programming 2">
          Advanced Programming 2
         </a>
         <div class="dropdown-divider">
         </div>
         <a class="dropdown-item" href="/teaching.html" title="teaching">
          All classes
         </a>
        </div>
       </li>
       <li class="nav-item dropdown">
        <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" id="navbarDropdown" role="button" title="Projects">
         Projects
        </a>
        <div aria-labelledby="navbarDropdown" class="dropdown-menu">
         <a class="dropdown-item" href="/opensource.html" title="Open Resources">
          Open Source 
         </a>
         <a class="dropdown-item" href="/technological-blog.html" title="Technological Blog">
          Technological Blog
         </a>
        </div>
       </li>
      </ul>
      <div class="form-inline my-2 my-lg-0 desktop">
       <input aria-label="Search" class="form-control input-search" id="search-data-2" placeholder="Search" type="search"/>
       <div class="input-group-append">
        <button class="btn btn-outline-white btn-search" onclick="return searchPage();">
         <img alt="search" src="https://img.icons8.com/android/24/000000/search.png"/>
        </button>
       </div>
      </div>
     </div>
    </nav>
    <div class="body">
     <div class="fluid-container">
      <div class="row">
       <div class="col-lg-12 col-md-12 col-sm-12">
        <div class="info" style="text-align: center;">
         <div class="alert alert-danger alert-dismissible fade show" id="error-search" role="alert" style="display: none">
          <strong>
           Page Not found
          </strong>
          , I am still working on our inner website search engine. Try again or use the navigation bar.
          <button aria-label="Close" class="close" onclick="return closeSearchAlert()" type="button">
           <span aria-hidden="true">
            ×
           </span>
          </button>
         </div>
         <h3>
          How my NN looks like?
         </h3>
         <p>
          <b>
           Note:
          </b>
          use "," to split the layers sizes.
         </p>
         <form style="text-align: left;">
          <div class="form-group">
           <label for="layers">
            Layers
           </label>
           <input class="form-control" id="layers" placeholder="Layers" type="text"/>
          </div>
          <div id="cnnPanel" style="display: none;">
           <div class="form-group">
            <label for="layers">
             Window Size
            </label>
            <input class="form-control" id="cnnSize" max="9" min="1" placeholder="Window Size" type="number" value="3"/>
           </div>
           <div class="form-group">
            <label for="layers">
             Window Movement
            </label>
            <input class="form-control" id="cnnMove" max="9" min="1" placeholder="Window Movement" type="number" value="1"/>
           </div>
          </div>
         </form>
         <button class="btn btn-secondary" onclick="redraw();" style="margin-top: 10px; margin-bottom: 10px;">
          Draw!
         </button>
         <button class="btn btn-warning" onclick="redrawRandom();" style="margin-top: 10px; margin-bottom: 10px;">
          Draw Random!
         </button>
         <div id="canvas_container">
         </div>
         <a alt="FNN case" class="btn btn-info" href="deep_leanring_nn_visual.html?type=fnn" style="margin-top: 10px;" title="Show FNN Case">
          Show FNN Case
         </a>
         <a alt="CNN case" class="btn btn-info" href="deep_leanring_nn_visual.html?type=cnn" style="margin-top: 10px;" title="Show CNN Case">
          Show CNN Case
         </a>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>
<!-- Random image generator -->
<script>
 let printType = new URLSearchParams(window.location.search).get('type');
	let nn; // declare pose object
	
	// general shape type
	class NN 
	{
		constructor(nodesPerLayer, netType) 
		{
			this.layers = [];
			var nodesSizes = nodesPerLayer.split(",");
			for (var i = 0; i < nodesSizes.length; i++)
			{
				var value = parseInt(nodesSizes[i]);
				if (value < 2 && netType == "fnn")
				{
					value = 2;
					alert("layer size cannot be less then '2' at index = " + i);
				}
				this.layers.push(value);
			}
			this.netType = netType;
		}

		display(screenWidth, screenHeight, cnnSize, cnnMove) 
		{
			// find sizes
			var circleColSpace = Math.floor(screenHeight / (max(this.layers) + 1));
			var circleRowSpace = Math.floor(screenWidth / (this.layers.length + 1));
			var r = Math.floor(circleColSpace / 3);
			fill(255);
			stroke('black'); 
			strokeWeight(3);
			// make all the nodes
			for (var i = 0; i < this.layers.length; i++)
			{
				var thisColCircleColSpace = Math.floor(screenHeight / this.layers[i] + 1);
				for (var j = 0; j < this.layers[i]; j++)
				{
					circle(circleRowSpace * (i+1), thisColCircleColSpace * (j+0.5), r);
				}
			}
			
			if (this.netType == "fnn")
			{
				// make all the edges
				for (var i = 0; i < this.layers.length - 1; i++)
				{
					var thisColCircleColSpace = Math.floor(screenHeight / this.layers[i] + 1);
					for (var j = 0; j < this.layers[i]; j++)
					{
						var nextColCircleColSpace = Math.floor(screenHeight / this.layers[i+1] + 1);
						for (var k = 0; k < this.layers[i+1]; k++)
						{
							line(circleRowSpace * (i+1) + r/4, thisColCircleColSpace * (j+0.5), circleRowSpace * (i+2) - r/4, nextColCircleColSpace * (k+0.5));
						}
					}
				}
			}
			else
			{
				// make all the nodes
				for (var i = 0; i < this.layers.length - 1; i++)
				{
					var thisColCircleColSpace = Math.floor(screenHeight / this.layers[i] + 1);
					var nextColCircleColSpace = Math.floor(screenHeight / this.layers[i+1] + 1);
					var move = 0;
					for (var j = 0; j < this.layers[i]; j++)
					{						
						for (var s = 0; s < cnnSize; s++)
						{
							if (j < this.layers[i + 1] && j + s + move < this.layers[i])
							{
								line(circleRowSpace * (i+1) + r/4, thisColCircleColSpace * (j + s + move + 0.5), circleRowSpace * (i+2) - r/4, nextColCircleColSpace * (j  + 0.5));
							}
						}
						move += cnnMove - 1;
					}
					/*
					for (var j = 0; j < this.layers[i]; j++)
					{
						line(circleRowSpace * (i+1) + r/4, thisColCircleColSpace * (j+0.5), circleRowSpace * (i+2) - r/4, nextColCircleColSpace * (Math.floor(j / cnnSize)+0.5));
					}
					*/
				}
			}
		}
	}
	
	function setup()
	{
		let cnv = createCanvas(1000, 400); // create canvas to draw on
		cnv.parent('canvas_container'); // set the location of the canvas in the right div
		stroke(255); // Set line drawing color to white
		background(240); // set BG to white
		frameRate(24);
		if (printType == "cnn")
		{
			document.getElementById("cnnPanel").style.display = "";
		}
		randomNN(); // generate some start random NN
		redraw();
	}
	
	function draw()
	{
		background(240); // set BG to white
		nn = new NN(document.getElementById("layers").value, printType);
		nn.display(width, height, parseInt(document.getElementById("cnnSize").value), parseInt(document.getElementById("cnnMove").value));
		noLoop();
	}
	
	function randomNN()
	{
		if (printType == "fnn")
		{
			var reduceSize = 3;
			var movement = 3;
			var layersCount = Math.floor(random(6)) + 2;
			var layersTxt = "";
			for (var i = 0; i < layersCount; i++)
			{
				layersTxt += Math.floor(random(9)+2) + ",";
			}
		}
		else
		{
			var reduceSize = 2 + Math.floor(random(3));
			var movement = reduceSize;
			if (movement > reduceSize)
			{
				movement = reduceSize;
			}
			var layers = Math.floor(random(4)) + 2;
			var lastLayer = Math.floor(random(5)) + 4;
			var layerSizes = [lastLayer];
			var countLayer = lastLayer;
			for (var layer = 1; layer < layers; layer++)
			{
				countLayer *= reduceSize;
				layerSizes.push(countLayer);
			}
			layerSizes = layerSizes.reverse();
			var layersTxt = "";
			for (var i = 0; i < layerSizes.length; i++)
			{
				layersTxt += layerSizes[i] + ","
			}
		}
		layersTxt = layersTxt.substring(0, layersTxt.length - 1);
		document.getElementById("layers").value = layersTxt;
		document.getElementById("cnnSize").value = reduceSize.toString();
		document.getElementById("cnnMove").value = movement.toString();
	}
	
	function redrawRandom()
	{
		randomNN();
		redraw();
	}
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js">
</script>
<script crossorigin="anonymous" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" src="https://code.jquery.com/jquery-3.5.1.slim.min.js">
</script>
<script crossorigin="anonymous" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js">
</script>
<script crossorigin="anonymous" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js">
</script>
<script src="../js/main.js">
</script>
<script src="../js/search.js">
</script>
